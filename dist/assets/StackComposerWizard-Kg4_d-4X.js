const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DpKukOXs.js","assets/index-s4ewU_Ro.css"])))=>i.map(i=>d[i]);
import{j as e,r as f,R as v,_ as j}from"./index-DpKukOXs.js";import{L as N}from"./LiveCodingConsole-Br8T0YkX.js";function w(r=8){const t="abcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let n=0;n<r;n++)a+=t[Math.floor(Math.random()*t.length)];return a}function C(){return{stepIndex:0,steps:["kick","hat","snare","bass","chords","lead","fx","groove","mix","master","review"],layers:[],meta:{bpm:128,meter:"4/4"}}}function k(r,t){switch(t.type){case"next":return{...r,stepIndex:Math.min(r.steps.length-1,r.stepIndex+1)};case"prev":return{...r,stepIndex:Math.max(0,r.stepIndex-1)};case"goto":return{...r,stepIndex:Math.min(r.steps.length-1,Math.max(0,t.index))};case"setMeta":return{...r,meta:{...r.meta,...t.patch}};case"startDraft":{const a={id:w(),role:t.role,descriptors:[]};return{...r,draft:a}}case"updateDraft":return r.draft?{...r,draft:{...r.draft,...t.patch}}:r;case"commitDraft":return r.draft?{...r,layers:[...r.layers,r.draft],draft:void 0}:r;case"discardDraft":return{...r,draft:void 0};case"updateLayer":return{...r,layers:r.layers.map(a=>a.id===t.id?{...a,...t.patch}:a)};default:return r}}function M({value:r,onChange:t}){return e.jsx("textarea",{className:"w-full min-h-[100px] bg-black/40 border border-slate-700 rounded p-2 text-[12px] font-mono focus:outline-none focus:border-cyan-400",value:r,onChange:a=>t(a.target.value),placeholder:"Enter DSL pattern (e.g. C4_E4.G4!_B4.-C5?)"})}function S(r){const t=r.descriptors.slice(0,3).join(" ");if(!r.pattern)return t||r.role;const n=r.pattern.replace(/[^xX]/g,"").length/Math.max(1,r.pattern.length)>.5?"busy":"sparse";return[t||r.role,n].filter(Boolean).join(" ")}function y(r){const t=r.descriptors.slice(0,3).join(" ");if(!r.pattern)return t||r.role;const n=(r.pattern.match(/_/g)||[]).length/Math.max(1,r.pattern.length)>.15?"legato":"staccato";return[t||r.role,n].filter(Boolean).join(" ")}function D(r){const t=[];t.push(`${r.meta.bpm} BPM ${r.meta.meter}`);const a=r.layers.filter(l=>["kick","hat","snare"].includes(l.role));a.length&&t.push("DRUMS: "+a.map(S).join(", "));const n=r.layers.find(l=>l.role==="bass");n&&t.push("BASS: "+y(n));const s=r.layers.find(l=>l.role==="chords");s&&t.push("CHORDS: "+y(s));const c=r.layers.find(l=>l.role==="lead");return c&&t.push("LEAD: "+y(c)),r.meta.swing&&t.push(`GROOVE: swing ${r.meta.swing}%`),r.meta.fxSummary&&t.push(`FX: ${r.meta.fxSummary}`),r.meta.mixNotes&&t.push(`MIX: ${r.meta.mixNotes}`),r.meta.masterNotes&&t.push(`MASTER: ${r.meta.masterNotes}`),t.join(`
`)}function R({state:r,dispatch:t,role:a,title:n,descriptorHints:s=[]}){var o;const c=((o=r.draft)==null?void 0:o.role)===a?r.draft:void 0,l=c||r.layers.find(d=>d.role===a),u=!!c;function b(){t({type:"startDraft",role:a})}function i(d){t({type:"updateDraft",patch:d})}function x(){t({type:"commitDraft"}),t({type:"next"})}function p(){t({type:"discardDraft"})}const h=(l==null?void 0:l.descriptors)||[];function g(d){const m=new Set(h);m.has(d)?m.delete(d):m.add(d),i({descriptors:[...m]})}return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsx("h2",{className:"text-xs uppercase tracking-widest text-cyan-300 mb-2",children:n}),!u&&!l&&e.jsxs("button",{onClick:b,className:"px-3 py-1.5 text-[11px] rounded border border-cyan-500 bg-cyan-600/20 hover:bg-cyan-600/30",children:["Add ",n]}),!u&&l&&e.jsxs("div",{className:"text-[11px] flex flex-col gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Descriptors:"})," ",l.descriptors.join(", ")||"(none)"]}),l.pattern&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Pattern:"})," ",e.jsx("code",{className:"bg-black/40 px-1 py-0.5 rounded border border-slate-700",children:l.pattern})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{onClick:b,className:"px-3 py-1 text-[11px] rounded border border-slate-600 hover:border-cyan-400",children:"Edit"}),e.jsx("button",{onClick:()=>t({type:"next"}),className:"px-3 py-1 text-[11px] rounded border border-emerald-500 bg-emerald-600/20 hover:bg-emerald-600/30",children:"Continue"})]})]}),u&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2 text-[11px]",children:s.map(d=>{const m=h.includes(d);return e.jsx("button",{onClick:()=>g(d),className:`px-2 py-1 rounded border ${m?"border-fuchsia-400 text-fuchsia-200 bg-fuchsia-600/20":"border-slate-600 text-slate-400 hover:border-fuchsia-400"}`,children:d},d)})}),e.jsx(M,{value:(c==null?void 0:c.pattern)||"",onChange:d=>i({pattern:d})}),e.jsxs("div",{className:"flex justify-between pt-1",children:[e.jsx("button",{onClick:p,className:"text-[11px] px-3 py-1 rounded border border-slate-600 hover:border-pink-400",children:"Discard"}),e.jsx("button",{onClick:x,className:"text-[11px] px-4 py-1 rounded border border-emerald-500 bg-emerald-600/20 hover:bg-emerald-600/30",children:"Save & Next"})]})]})]})})}function E({state:r,dispatch:t}){function a(s){t({type:"setMeta",patch:s})}const n=r.meta;return e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 space-y-4",children:[e.jsx("h2",{className:"text-xs uppercase tracking-widest text-cyan-300",children:"Groove"}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px]",children:["Swing %",e.jsx("input",{type:"number",value:n.swing||0,onChange:s=>a({swing:Number(s.target.value)||0}),className:"bg-black/40 border border-slate-600 rounded px-2 py-1 w-20"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-[11px]",children:["Humanize ms",e.jsx("input",{type:"number",value:n.humanizeMs||0,onChange:s=>a({humanizeMs:Number(s.target.value)||0}),className:"bg-black/40 border border-slate-600 rounded px-2 py-1 w-20"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>t({type:"next"}),className:"px-3 py-1.5 text-[11px] rounded border border-emerald-500 bg-emerald-600/20 hover:bg-emerald-600/30",children:"Continue"})})]})}function I({state:r,dispatch:t}){function a(s){t({type:"setMeta",patch:s})}const n=r.meta;return e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 space-y-4",children:[e.jsx("h2",{className:"text-xs uppercase tracking-widest text-fuchsia-300",children:"FX"}),e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4 text-[11px]",children:[e.jsxs("label",{className:"flex flex-col gap-1",children:["Reverb",e.jsx("input",{type:"range",min:0,max:100,value:n.fxReverb||0,onChange:s=>a({fxReverb:Number(s.target.value)})})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:["Delay",e.jsx("input",{type:"range",min:0,max:100,value:n.fxDelay||0,onChange:s=>a({fxDelay:Number(s.target.value)})})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:["Sidechain",e.jsx("input",{type:"range",min:0,max:100,value:n.fxSidechain||0,onChange:s=>a({fxSidechain:Number(s.target.value)})})]})]}),e.jsx("textarea",{placeholder:"FX summary (e.g. subtle long-tail shimmer, tight slapback on lead)...",value:n.fxSummary||"",onChange:s=>a({fxSummary:s.target.value}),className:"w-full h-28 bg-black/30 border border-slate-700 rounded p-2 text-[11px]"}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>t({type:"next"}),className:"px-3 py-1.5 text-[11px] rounded border border-emerald-500 bg-emerald-600/20 hover:bg-emerald-600/30",children:"Continue"})})]})}function L({state:r,dispatch:t}){function a(s){t({type:"setMeta",patch:s})}const n=r.meta;return e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 space-y-4",children:[e.jsx("h2",{className:"text-xs uppercase tracking-widest text-emerald-300",children:"Mix"}),e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4 text-[11px]",children:[e.jsxs("label",{className:"flex flex-col gap-1",children:["Drum/Bass Balance",e.jsx("input",{type:"range",min:0,max:100,value:n.mixLowBalance||50,onChange:s=>a({mixLowBalance:Number(s.target.value)})})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:["Mid Clarity",e.jsx("input",{type:"range",min:0,max:100,value:n.mixMidClarity||50,onChange:s=>a({mixMidClarity:Number(s.target.value)})})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:["High Air",e.jsx("input",{type:"range",min:0,max:100,value:n.mixHighAir||50,onChange:s=>a({mixHighAir:Number(s.target.value)})})]})]}),e.jsx("textarea",{placeholder:"Mix notes (e.g. tight low-end, scooped low-mids, airy hats)...",value:n.mixNotes||"",onChange:s=>a({mixNotes:s.target.value}),className:"w-full h-28 bg-black/30 border border-slate-700 rounded p-2 text-[11px]"}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>t({type:"next"}),className:"px-3 py-1.5 text-[11px] rounded border border-emerald-500 bg-emerald-600/20 hover:bg-emerald-600/30",children:"Continue"})})]})}function $({state:r,dispatch:t}){function a(s){t({type:"setMeta",patch:s})}const n=r.meta;return e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4 space-y-4",children:[e.jsx("h2",{className:"text-xs uppercase tracking-widest text-cyan-300",children:"Master"}),e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4 text-[11px]",children:[e.jsxs("label",{className:"flex flex-col gap-1",children:["Loudness",e.jsx("input",{type:"range",min:-12,max:-5,value:n.masterLufs||-9,onChange:s=>a({masterLufs:Number(s.target.value)})})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:["Width",e.jsx("input",{type:"range",min:0,max:100,value:n.masterWidth||50,onChange:s=>a({masterWidth:Number(s.target.value)})})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:["Tone Tilt",e.jsx("input",{type:"range",min:-50,max:50,value:n.masterTilt||0,onChange:s=>a({masterTilt:Number(s.target.value)})})]})]}),e.jsx("textarea",{placeholder:"Mastering notes (e.g. transparent glue, gentle high shelf, tight low control)...",value:n.masterNotes||"",onChange:s=>a({masterNotes:s.target.value}),className:"w-full h-28 bg-black/30 border border-slate-700 rounded p-2 text-[11px]"}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>t({type:"next"}),className:"px-3 py-1.5 text-[11px] rounded border border-emerald-500 bg-emerald-600/20 hover:bg-emerald-600/30",children:"Continue"})})]})}function _({state:r}){const t=D(r);return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[e.jsx("h2",{className:"text-xs uppercase tracking-widest text-cyan-300 mb-2",children:"Review & Export"}),e.jsx("pre",{className:"text-[11px] whitespace-pre-wrap leading-relaxed bg-black/40 p-3 rounded border border-slate-700 min-h-[220px]",children:t}),e.jsx("button",{onClick:()=>navigator.clipboard.writeText(t),className:"mt-3 px-3 py-1.5 text-[11px] rounded border border-cyan-500 bg-cyan-600/20 hover:bg-cyan-600/30",children:"Copy Prompt"})]})})}function A(){const[r,t]=f.useReducer(k,void 0,C),a=r.steps[r.stepIndex],n=f.useRef([]),[s,c]=v.useState(!1),[l,u]=v.useState(!1);f.useEffect(()=>{let i=!1;return(async()=>{const x=await j(()=>import("./index-DpKukOXs.js").then(o=>o.e),__vite__mapDeps([0,1]));if(i)return;const p=x.liveEngine,h=r.layers.map(o=>o.id),g=n.current;for(const o of g)h.includes(o)||p.stop(o);for(const o of r.layers)o.pattern&&p.play(o.id,{pattern:o.pattern,type:o.role,gain:o.role==="kick"?.9:o.role==="snare"?.7:o.role==="hat"?.4:.6});n.current=h,r.meta.swing!=null&&p.setSwing(r.meta.swing)})(),()=>{i=!0}},[r.layers,r.meta.swing]);function b(){if(a==="review")return e.jsx(_,{state:r,dispatch:t});if(a==="groove")return e.jsx(E,{state:r,dispatch:t});if(a==="fx")return e.jsx(I,{state:r,dispatch:t});if(a==="mix")return e.jsx(L,{state:r,dispatch:t});if(a==="master")return e.jsx($,{state:r,dispatch:t});if(["kick","hat","snare","bass","chords","lead"].includes(a)){const i=a==="kick"?["punchy","deep","distorted","analog"]:a==="hat"?["tight","sizzle","open","offbeat"]:a==="snare"?["snappy","crisp","body","clap"]:a==="bass"?["growl","sub","saw","plucky"]:a==="chords"?["lush","warm","detuned","airy"]:["bright","metallic","aggressive","soft"];return e.jsx(R,{role:a,title:a.toUpperCase(),state:r,dispatch:t,descriptorHints:i})}return e.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 p-6 text-[12px] space-y-4",children:[e.jsxs("div",{className:"text-cyan-300 text-xs uppercase",children:[a," (placeholder)"]}),e.jsx("p",{className:"text-slate-400",children:"This step will be implemented later."}),e.jsx("button",{onClick:()=>t({type:"next"}),className:"px-3 py-1.5 text-[11px] rounded border border-emerald-500 bg-emerald-600/20 hover:bg-emerald-600/30",children:"Continue"})]})}return e.jsxs("div",{className:"w-full min-h-screen px-6 py-8 text-slate-100 app-dark-root space-y-8 relative",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-lg font-semibold tracking-wider bg-clip-text text-transparent bg-gradient-to-r from-cyan-300 via-fuchsia-300 to-emerald-300",children:"STACK COMPOSER"}),e.jsxs("div",{className:"flex gap-2 text-[11px]",children:[e.jsxs("span",{className:"text-slate-500",children:["Step ",r.stepIndex+1,"/",r.steps.length]}),r.stepIndex>0&&e.jsx("button",{onClick:()=>t({type:"prev"}),className:"px-2 py-1 rounded border border-slate-600 hover:border-cyan-400",children:"Prev"}),r.stepIndex<r.steps.length-1&&e.jsx("button",{onClick:()=>t({type:"next"}),className:"px-2 py-1 rounded border border-slate-600 hover:border-emerald-400",children:"Skip"})]})]}),e.jsx("div",{className:"max-w-3xl mx-auto",children:b()}),e.jsx("div",{className:"flex flex-wrap gap-1 pt-4",children:r.steps.map((i,x)=>{const p=x===r.stepIndex;return e.jsx("button",{onClick:()=>t({type:"goto",index:x}),className:`w-4 h-4 rounded-full border ${p?"bg-cyan-400 border-cyan-300":"border-slate-600 hover:border-cyan-400"}`,title:i},i+x)})}),e.jsx("div",{className:`fixed bottom-6 right-0 z-40 group ${s?"translate-x-0":"translate-x-[calc(100%-52px)]"} transition-transform duration-300`,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:e.jsxs("div",{className:`flex items-center gap-2 pl-4 pr-3 py-2 rounded-l-xl shadow-lg border border-r-0 backdrop-blur-md cursor-pointer select-none
          ${s?"bg-cyan-600/30 border-cyan-500/40":"bg-slate-800/60 border-slate-600/40 hover:bg-slate-700/70"}`,onClick:()=>c(i=>!i),children:[e.jsx("span",{className:"text-[11px] tracking-wide text-slate-200",children:s?"LIVE CODING":"LIVE"}),e.jsx("button",{onClick:i=>{i.stopPropagation(),c(!1)},className:`text-slate-400 hover:text-cyan-200 text-xs px-1 rounded transition-opacity ${s||l?"opacity-100":"opacity-0"} focus:opacity-100`,"aria-label":"Close live coding console",children:"×"})]})}),e.jsx("div",{className:`fixed top-0 right-0 h-full w-full sm:w-[640px] z-30 shadow-lg transition-transform duration-300 ${s?"translate-x-0":"translate-x-full"}`,children:s&&e.jsx(N,{onClose:()=>c(!1)})})]})}export{A as default};
